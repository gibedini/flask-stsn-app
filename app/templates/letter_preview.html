{% extends 'base.html' %}
{% block title %}Lettere personalizzate{% endblock %}
{% block content %}
<h2>Genera lettera da template</h2>
<form method="post" class="mb-4">
  <div class="mb-3">
    <label for="template" class="form-label">Seleziona un template</label>
    <select class="form-select" name="template" id="template" required>
      <option value="" disabled {% if not selected %}selected{% endif %}>-- scegli --</option>
      {% for t in templates %}
        <option value="{{ t[0] }}" {% if t[0] == selected %}selected{% endif %}>{{ t[1] or t[0] }}</option>
      {% endfor %}
    </select>
  </div>
  <button class="btn btn-primary">Mostra anteprima</button>
</form>
{% if selected %}
<form method="post" action="{{ url_for('export_lettere') }}">
  <input type="hidden" name="template" value="{{ selected }}">
  <button class="btn btn-success mt-3">Esporta in CSV</button>
</form>
{% endif %}

{% if anteprima %}
  <div class="card">
    <div class="card-body">
      <pre>{{ anteprima }}</pre>
    </div>
  </div>
{% endif %}
{% endblock %}